# 美股公司财报处理与可视化
**基于 n8n 及 OpenBB 的半自动化工作流**


![美股财报流程图](/earnings/n8n_incomestatement.png)


<div class="earnings-link-box">
  <span class="emoji">👉</span>
  <a class="earnings-link-text" href="/earnings/catalogue/">点击跳转美股公司财报分析</a>
</div>




## 📌 它是什么？

这是一个基于 n8n 搭建的**美股公司财报自动处理与可视化工作流**，旨在：

- 自动抓取当日或指定日期范围内发布季度财报的美股公司
- 提取关键财务字段并标准化格式
- 生成适配 Sankey 图的数据格式
- 自动写入 Google Sheet
- 同时整合财报会议内容并交由 AI 翻译与提炼要点


## ⚙️ 它是如何运作的？

### 📅 获取今日公布财报的公司列表
- 使用 [**FMP API**](https://site.financialmodelingprep.com/) 的财报日历接口，设定日期范围，获取所有发布财报的公司股票代码列表，储存为多个数组供后续使用

### 🌐 动态逐个请求财报数据
- 通过 n8n 内 **HTTP Request 节点** 循环请求每家公司的利润表及各业务线收入数据
- 每个请求的 URL 都**动态拼接**当前公司股票代码

### 🧹 筛选 & 重构 & 格式化数据字段
- 使用 **Code 节点** 筛选每家公司最新季度/全年财报数据，并提取**总收入、毛利润、运营费用、税前收入等**字段
- 使用 **Merge 节点** 将利润表数据与各业务线收入数据按公司连接起来
- 使用 **Code 节点** 将数据转化为**from、to、value三字段结构**用来制作桑基图表并适配 Google Sheet 写入格式

### 📤 写入 Google Sheet
- 所有数据整合后写入 Google Sheet
- 每家公司为一组记录，结构适配用于图表生成工具

### 📊 生成 Sankey 可视化图
- 使用 [Sankeyart](https://www.sankeyart.com/) 一键制作 Sankey 图

### 📄 整合财报会议内容
- 使用 [**OpenBB**](https://pro.openbb.co) 调用公司最近的**财报电话会议演讲稿**
- 调用 **OpenBB** 内置 AI 功能对会议内容进行中英文翻译与摘要提炼


## ✅ 它有什么优势？
- 每日可定时运行，利用 n8n 实现全自动化数据流，极大提升财务分析效率
- 通过动态修改 HTTP 链接，实现一次性抓取当日所有公司财报数据内容，最大程度节省数据处理时间
- FMP API提供已处理的结构化数据，避免了每个公司财报数据标准不统一的问题
- 输出结果直接支持 Sankey 图数据格式，可视化展示公司收入、支出与利润路径
- OpenBB 内置 AI 工具可生成简明易懂的摘要，辅助快速理解当季公司业务亮点及未来展望，提升研报撰写效率
- 可拓展性强：支持爬取任意财报数据、支持自动生成简单表格（如：折线图、柱状图等）


## 💡 未来优化方向
- 在 n8n 上接入适配 BI 工具， 省略掉手动制作 Sankey 图的步骤
- 接入 OpenBB 所处理的会议内容摘要，实现全流程自动化输出文档
